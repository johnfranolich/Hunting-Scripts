# Hunting-Scripts
A collection of hunting, blue team scripts and tools ; mostly others.

PowerShell--

Find Kerberos Golden Tickets https://gallery.technet.microsoft.com/scriptcenter/Kerberos-Golden-Ticket-b4814285 & https://github.com/spohara79/TGT---Golden-Silver-Ticket

Skeleton Key scanner https://gallery.technet.microsoft.com/Aorato-Skeleton-Key-24e46b73

Detect ruler attacks in Exchange and DC logs https://sensepost.com/blog/2017/notruler-turning-offence-into-defence/ 

A PowerShell script to interact with the MITRE ATT&CK Framework via its own API  https://github.com/Cyb3rWard0g/Invoke-ATTACKAPI

Power Forensics https://github.com/Invoke-IR/PowerForensics

PS IR https://github.com/mgreen27/Powershell-IR https://www.linkedin.com/pulse/invoke-liveresponse-matthew-green

DeepBlue CLI https://github.com/sans-blue-team/DeepBlueCLI

Jason Fossen's https://github.com/EnclaveConsulting/SANS-SEC505

PS script to detects memory-only CLR (.NET) modules https://gist.github.com/dezhub/2875fa6dc78083cedeab10abc551cb58 

Flare http://boxstarter.org/package/url?https://raw.githubusercontent.com/fireeye/flare-vm/master/flarevm_malware.ps1 https://github.com/fireeye/flare-vm

RVMI Rekall https://github.com/fireeye/rvmi-rekall

List Kerberos Tickets https://gallery.technet.microsoft.com/scriptcenter/List-All-Cached-Kerberos-5ba41829

List local admins https://gallery.technet.microsoft.com/scriptcenter/ed4a0cb7-603c-488d-afeb-194b7a60f42f

Get AD Trust Topology https://gallery.technet.microsoft.com/scriptcenter/ADFS-Security-Audit-Events-81c207cf & https://github.com/WiredPulse/PowerShell/blob/master/Active_Directory/Get-DomainTrusts.ps1

ADFS Security Audit Events Parser https://gallery.technet.microsoft.com/scriptcenter/ADFS-Security-Audit-Events-81c207cf

Self Signign Certs https://gallery.technet.microsoft.com/scriptcenter/Get-AD-Trust-Topology-f8f2d1d7 & http://cyberfibers.com/2017/11/hunting-self-signed-certificates/

Encrypt/Decrypt files using AES encryption https://gallery.technet.microsoft.com/scriptcenter/EncryptDecrypt-files-use-65e7ae5d

Get the status of A/V local or remote https://gallery.technet.microsoft.com/scriptcenter/Get-the-status-of-4b748f25

List SPNs https://gallery.technet.microsoft.com/List-all-SPNs-Used-in-your-e0c6267a

Invoke web request detection https://gist.github.com/Centurion89/33b9517b75d238b59fd85fd060514279

Another PS list https://www.peerlyst.com/posts/resource-infosec-powershell-tools-resources-and-authors

Managing PowerShell in a modern corporate environment https://www.nccgroup.trust/uk/our-research/managing-powershell-in-a-modern-corporate-environment/

Detect PS obfuscation https://github.com/jaapbrasser/Events/blob/master/2017-09-01_BSidesAms2017/Demo/Demo2.ps1 vid https://www.youtube.com/watch?v=WOC8vC2KoNs&list=PLwZycuzv10iLBFwRIWNAR-s4iuuUMRuEB&index=12

PoSH IR and PS https://github.com/WiredPulse/PoSh-R2 

PS hash compare, find bad CCleaner example, net conns http://cyberfibers.com/category/powershell/ 

EternalBlue vul scan https://gallery.technet.microsoft.com/scriptcenter/EternalBlue-Vulnerability-bf3ad11d

Generate Applocker rule based on hash https://gallery.technet.microsoft.com/scriptcenter/Generate-AppLocker-baaa9278

Check Autoruns at bootup https://gallery.technet.microsoft.com/scriptcenter/Malware-detection-and-995f01eb

CERT diff https://isc.sans.edu/forums/diary/Keep+An+Eye+on+your+Root+Certificates/23030/

fake sandbox https://github.com/Phoenix1747/fake-sandbox

Various PS https://github.com/WiredPulse/PowerShell

Hunt PS scripts https://github.com/DLACERT/ThreatHunting

Detect PTH https://github.com/cyberark/ketshash

Detect shadow admins https://github.com/cyberark/ACLight

Find Exchange Mailboxes with Forwarding Addresses Enabled http://www.syspanda.com/index.php/2018/01/10/exchange-find-mailboxes-forwarding-addresses-enabled/


Yara--

Signaturing an Authenticode anomaly with Yara https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2017/september/signaturing-an-authenticode-anomaly-with-yara/

Loki https://github.com/Neo23x0/Loki 

Entropy of PE files https://cyberdefenses.com/yara-entropy-bit-math/

Rule for CCleaner https://blog.nviso.be/2017/09/21/yara-rules-for-ccleaner-5-33/

Detect MimiK golden ticket https://blog.didierstevens.com/2016/08/12/mimikatz-golden-ticket-dcsync/

HEX to assembly https://haiderm.com/convert-hex-assembly-using-simple-python-script/

Bin/API analysis including FN2Yara https://github.com/cmu-sei/pharos


Python--

Script for malware analysis https://github.com/beenuar/Py-DarkC0de/blob/master/analyse_malware.py

Make your own Volatility plug-in https://github.com/iAbadia/Volatility-Plugin-Tutorial

Kill Chain Fuzzer https://github.com/SafeBreach-Labs/blog-snippets/blob/master/killchainfuzzer.py

FastIR https://github.com/SekoiaLab/Fastir_Collector

Mystique - enterprise malicoius mutex detection https://github.com/MinervaLabsResearch/Mystique

SSDeep Elastic https://github.com/intezer/ssdeep-elastic

Memory Patch detector https://github.com/intezer/MemoryPatchDetector

 Script to compare your similar Linux cloud application servers with each other to discover possible indications of compromise. https://github.com/morphuslabs/distinct
 
Phishing catcher using Certstream (https://certstream.calidog.io/)  https://github.com/x0rz/phishing_catcher

Leak File Analyzer https://github.com/Neo23x0/radiocarbon

Find miners https://github.com/wrinkl3/MineSweepR

Inspect PDFs https://github.com/jesparza/peepdf

User simulation https://github.com/cmu-sei/usersim

Misc--

Open source tools Netflix Security Team https://medium.com/netflix-techblog/a-brief-history-of-open-source-from-the-netflix-cloud-security-team-412b5d4f1e0c

PS to exe https://github.com/interference-security/PS2EXE

YARA signature to check for DEP and ASLR https://summitroute.com/blog/2017/07/24/yara_sigs_for_security_best_practices/

CyLR CDQR Forensics Virtual Machine (CCF-VM) https://github.com/rough007/CCF-VM (a-z - endpoint IR collection to dbase backend)

Threat Hunting Playbook https://github.com/Kathayra/ThreatHunter-Playbook TH tracking https://github.com/Kathayra/HT-Trackr

Android Vul tester https://github.com/AndroidVTS/android-vts 

Sysmon config https://github.com/SwiftOnSecurity/sysmon-config

GRR write up https://chip-dfir.techanarchy.net/?p=395 

Detect dll hijacking https://github.com/adamkramer/dll_hijack_detect

Detection mapped to Mitre Matrix https://github.com/redcanaryco/atomic-red-team

.NET runtine inspector https://github.com/enkomio/shed

harden windows https://github.com/securitywithoutborders/hardentools/releases/tag/v1.0

Deception -- It is all about the buzz

Emulate VM enviromnts https://github.com/adamkramer/rapid_env

test a sandox - PoC malware with good intentions https://github.com/LordNoteworthy/al-khaser


Pafish - Testing tool to emulate an infection https://github.com/a0rtega/pafish

https://canarytokens.org/generate 

todo: FTK scripting https://accessdata.com/product-download/windows-32bit-3.1.1/

Hook Finder https://github.com/hasherezade/hook_finder

Lateral Movement script https://securelist.com/happy-ir-in-the-new-year/83557/

find dll injects http://cyberfibers.com/2017/11/525/


other lists --

https://github.com/rshipp/awesome-malware-analysis


