title: RedLine Malware using GCP
Date: 
author: John Franolich & Open AI
description: Detects RedLine Malware used in conjuction with Google Cloud Platform.  The path & file locations of the local GCP client secrets, access token, SQLite db, bearer token detials are from SANS SEC488 Author Ryan Nicholson's class.  
	
Open AI comments are: Note that this rule will only work if the path to the Login Data files is hardcoded into the rule. If the path to the files is variable (e.g., if the username of the user is different on each system), you will need to use a more complex rule to locate the files. Let me know if you have any questions about this!

reference:
- https://services.google.com/fh/files/blogs/gcat_threathorizons_full_jan2023.pdf
- https://asec.ahnlab.com/en/29885/

date: '2023-01-08'

tags:
- attack.execution
- attack.t1101
- attack.t1083
- attack.c2
- attack.initial_access
- attack.persistence
- attack.privilege_escalation
- malware.redline
logsource:
  product: unknown
  service: unknown
  definition: Search for RedLine malware used in conjuction with Google Cloud Platform.
detection:
  condition: all of them
  filesize < 50MB and
  (
    filepath contains "Chrome" and filepath contains "User Data" and filepath contains "Default"
    or
    filepath contains "MicrosoftEdge" and filepath contains "User" and filepath contains "Default"
    or
    filepath contains "Opera Software" and filepath contains "Opera Stable"
    or
    filepath contains "Naver" and filepath contains "Naver Whale" and filepath contains "User Data" and filepath contains "Default"
    or
    filepath contains "gcloud" and filepath contains "configuration" and filepath contains "config_default"
    or
    filepath contains "gcloud" and filepath contains "credentials.db"
    or
    filepath contains "gcloud" and filepath contains "access_tokens.db"
  ) and
  strings:
    - "Login Data"
  or
  process_name: '*'
  and
  network_tcp_src_port: 15647
  or
  process_name: '*'
  and
  network_tcp_dst_port: 15647
level: medium
